{"version":3,"file":"hyperleaflet.esm.js","sources":["../src/Hyperchange/hyperchange.js","../src/utils.js","../src/config.js","../src/Map/events.js","../src/Map/map.js","../src/Geometry/events.js","../src/Geometry/geometry.js","../src/Hyperleaflet/hyperleafletGeometryHandler.js","../src/Hyperleaflet/events.js","../src/Layers/layers.js","../src/Layers/tileLayers.js","../src/Hyperleaflet/eventTarget.js","../src/Hyperleaflet/hyperleaflet.js","../src/index.js"],"sourcesContent":["const hyperChangeDetection = {\n  events: {},\n\n  /** @param {{ targetSelector: string, uniqueAttribute: string, attributeFilter: string[] }} options */\n  observe({ targetSelector, uniqueAttribute, attributeFilter }) {\n    if (this.events[targetSelector]) {\n      throw new Error(\"Can't observe the same target twice\");\n    }\n    observeChangesInTarget(targetSelector, uniqueAttribute, attributeFilter);\n    this.events[targetSelector] = {};\n  },\n\n  /** @param {string} targetSelector @param {string} evName @param {Function} callback */\n  subscribe(targetSelector, evName, callback) {\n    this.events[targetSelector][evName] = this.events[targetSelector][evName] || [];\n    this.events[targetSelector][evName].push(callback);\n  },\n\n  /** @param {string} targetSelector @param {string} evName @param {Function} callback */\n  unsubscribe(targetSelector, evName, callback) {\n    if (this.events[targetSelector][evName]) {\n      this.events[targetSelector][evName] = this.events[targetSelector][evName].filter((f) => f !== callback);\n    }\n  },\n\n  /** @param {string} targetSelector @param {string} evName @param {*} data */\n  publish(targetSelector, evName, data) {\n    if (this.events[targetSelector][evName]) {\n      this.events[targetSelector][evName].forEach((f) => f(data));\n    }\n  },\n};\n\nfunction observeChangesInTarget(targetSelector, uniqueAttribute, attributeFilter) {\n  const isEqualNode = (oldNode, newNode, attributes) =>\n    attributes.every((attribute) => oldNode.getAttribute(attribute) === newNode.getAttribute(attribute));\n\n  function findNodesWithAttribute(nodes) {\n    const result = [];\n    nodes.forEach((node) => {\n      if (node.nodeType === 1) {\n        if (node.hasAttribute(uniqueAttribute)) {\n          result.push(node);\n        }\n        result.push(...findNodesWithAttribute(node.childNodes));\n      }\n    });\n    return result;\n  }\n\n  const observer = new MutationObserver((mutationsList) => {\n    const removedNodes = [];\n    const addedNodes = [];\n\n    mutationsList.forEach((mutation) => {\n      if (mutation.type === 'childList') {\n        removedNodes.push(...findNodesWithAttribute(mutation.removedNodes));\n        addedNodes.push(...findNodesWithAttribute(mutation.addedNodes));\n      } else if (mutation.type === 'attributes') {\n        const attribute = mutation.attributeName;\n        const attributeChange = {\n          attribute,\n          from: mutation.oldValue,\n          to: mutation.target.getAttribute(attribute),\n          [uniqueAttribute]: mutation.target.getAttribute(uniqueAttribute),\n        };\n        const changedNode = [{ dataset: mutation.target.dataset, ...attributeChange }];\n        hyperChangeDetection.publish(targetSelector, 'node_changes', changedNode);\n      }\n    });\n\n    const changedNodes = [];\n    const removedNodeMap = new Map(removedNodes.map((node) => [node.getAttribute(uniqueAttribute), node]));\n    const jointNodeSet = new Set();\n\n    addedNodes.forEach((addNode) => {\n      const addNodeId = addNode.getAttribute(uniqueAttribute);\n      const oldNode = removedNodeMap.get(addNodeId);\n      if (oldNode) {\n        jointNodeSet.add(addNodeId);\n      }\n      if (oldNode && !isEqualNode(oldNode, addNode, attributeFilter)) {\n        const attributeChanges = attributeFilter.reduce((changes, attr) => {\n          const from = oldNode.getAttribute(attr);\n          const to = addNode.getAttribute(attr);\n          if (from !== to) {\n            changes.push({ attribute: attr, from, to, [uniqueAttribute]: addNodeId });\n          }\n          return changes;\n        }, []);\n        changedNodes.push({ ...attributeChanges, dataset: addNode.dataset });\n      }\n    });\n\n    const reallyRemovedNodes = removedNodes.filter((node) => !jointNodeSet.has(node.getAttribute(uniqueAttribute)));\n    const reallyAddedNodes = addedNodes.filter((node) => !jointNodeSet.has(node.getAttribute(uniqueAttribute)));\n\n    if (reallyAddedNodes.length) {\n      hyperChangeDetection.publish(targetSelector, 'node_adds', reallyAddedNodes);\n    }\n    if (changedNodes.length) {\n      hyperChangeDetection.publish(targetSelector, 'node_changes', changedNodes);\n    }\n    if (reallyRemovedNodes.length) {\n      hyperChangeDetection.publish(targetSelector, 'node_removes', reallyRemovedNodes);\n    }\n  });\n\n  const targetNode = document.querySelector(targetSelector);\n  observer.observe(targetNode, {\n    childList: true,\n    subtree: true,\n    attributes: true,\n    attributeFilter,\n    attributeOldValue: true,\n  });\n}\n\nexport default hyperChangeDetection;\n","function isObject(item) {\n  return item && typeof item === 'object' && !Array.isArray(item);\n}\n\nexport function mergeDeep(target, source) {\n  const output = { ...target };\n  if (isObject(target) && isObject(source)) {\n    Object.keys(source).forEach((key) => {\n      if (isObject(source[key])) {\n        if (key in target && isObject(target[key])) {\n          output[key] = mergeDeep(target[key], source[key]);\n        } else {\n          output[key] = source[key];\n        }\n      } else {\n        output[key] = source[key];\n      }\n    });\n  }\n  return output;\n}\n","import { mergeDeep } from './utils';\n\nconst defaultOptions = {\n  reverseCoordinateOrder: false,\n  mapElement: '#map',\n  events: {\n    target: 'window',\n    map: {\n      click: true,\n      dblclick: false,\n      mousedown: false,\n      mouseover: false,\n      mousemove: false,\n      mouseout: false,\n      contextmenu: false,\n      preclick: false,\n      zoom: true,\n      move: true,\n      zoomstart: false,\n      zoomend: false,\n      movestart: false,\n      moveend: false,\n      ready: true,\n    },\n    geometry: {\n      click: true,\n      move: false,\n      add: false,\n    },\n    hyperleaflet: {\n      ready: true,\n    },\n  },\n  styles: {},\n};\nexport const Config = {\n  _hyperleaflet: null,\n  _options: defaultOptions,\n\n  get options() {\n    return this._options;\n  },\n\n  set options(options) {\n    this._options = mergeDeep(this._options, options);\n  },\n\n  reset() {\n    this._options = defaultOptions;\n  },\n\n  getTarget() {\n    const { target } = this.options.events;\n    switch (target) {\n      case 'window':\n        return window;\n      case 'document':\n        return document;\n      case 'hyperleaflet':\n      default:\n        return this._hyperleaflet;\n    }\n  },\n};\n","import { Config } from '../config';\n\nfunction createStateEvent(map, eventName, _leafletEvent) {\n  const bounds = map.getBounds();\n  const min = bounds.getSouthWest();\n  const max = bounds.getNorthEast();\n  const bboxString = bounds.toBBoxString();\n  return new CustomEvent(eventName, {\n    detail: { zoom: map.getZoom(), center: map.getCenter(), bbox: { min, max }, bboxString, _leafletEvent },\n  });\n}\n\nconst stateEvents = ['zoomstart', 'zoomend', 'movestart', 'moveend', 'zoom', 'move'];\nconst mouseEvents = [\n  'click',\n  'dblclick',\n  'mousedown',\n  'mouseover',\n  'mouseout',\n  'mousemove',\n  'contextmenu',\n  'preclick',\n];\n\nexport function setMapEvents(map) {\n  const eventTarget = Config.getTarget('map');\n  const mapEvents = Config.options.events.map;\n  Object.entries(mapEvents).forEach(([eventName, value]) => {\n    if (value) {\n      if (stateEvents.includes(eventName)) {\n        map.on(eventName, (e) => {\n          const event = createStateEvent(map, `map:${eventName}`, e);\n          eventTarget.dispatchEvent(event);\n        });\n      }\n      if (mouseEvents.includes(eventName)) {\n        map.on(eventName, (e) => {\n          const event = new CustomEvent(`map:${eventName}`, { detail: { point: e.latlng }, _leafletEvent: e });\n          eventTarget.dispatchEvent(event);\n        });\n      }\n    }\n  });\n\n  if (mapEvents.ready) {\n    map.whenReady(() => {\n      const event = createStateEvent(map, 'map:ready');\n      eventTarget.dispatchEvent(event);\n    });\n  }\n}\n","import * as L from 'leaflet';\nimport { setMapEvents } from './events';\nimport { Config } from '../config';\n\nfunction reverseCoordinates(point) {\n  return point.reverse();\n}\n\nfunction safeParsePoint(pointJson, reverse = false) {\n  try {\n    const point = JSON.parse(pointJson);\n    return reverse ? reverseCoordinates(point) : point;\n  } catch (_) {\n    return [0, 0];\n  }\n}\n\nexport const Map_ = {\n  map: null,\n  create(mapContainer) {\n    const config = Config;\n    const { mapConfig } = mapContainer.dataset;\n    const target = mapConfig ? document.querySelector(mapConfig) : mapContainer;\n    if (!target) throw new Error('No map config found');\n\n    const { center, zoom, minZoom, maxZoom } = target.dataset;\n\n    const { reverseCoordinateOrder } = config.options;\n    const mapView = {\n      center: safeParsePoint(center, reverseCoordinateOrder),\n      zoom: zoom || 1,\n    };\n    const leafletMap = L.map(mapContainer, {\n      center: mapView.center,\n      zoom: mapView.zoom,\n      minZoom: minZoom || 0,\n      maxZoom: maxZoom || 18,\n    });\n    setMapEvents(leafletMap);\n    return [leafletMap, target];\n  },\n};\n","import { Config } from '../config';\n\nexport function setEvents(leafletObject, id, eventType) {\n  const eventTarget = Config.getTarget('map');\n\n  if (Config.options.events.geometry.click) {\n    if (eventType === 'mono') {\n      leafletObject.on('click', (e) => {\n        const event = new CustomEvent('geometry:click', {\n          detail: { clickedPoint: e.latlng, geometry: leafletObject.getLatLng(), id },\n        });\n        eventTarget.dispatchEvent(event);\n      });\n    } else if (eventType === 'poly') {\n      leafletObject.on('click', (e) => {\n        const event = new CustomEvent('geometry:click', {\n          detail: {\n            clickedPoint: e.latlng,\n            geometry: leafletObject.getLatLngs(),\n            id,\n          },\n        });\n        eventTarget.dispatchEvent(event);\n      });\n    } else {\n      throw new Error('Invalid event type');\n    }\n  }\n}\n\nexport function sendEvent(eventType, leafletGeometry, id, geometryType, target) {\n  const eventTarget = Config.getTarget('map');\n\n  if (Config.options.events.geometry.add) {\n    const event = new CustomEvent(`geometry:${eventType}`, {\n      detail: { id, geometryType, target },\n    });\n    eventTarget.dispatchEvent(event);\n  }\n}\n","import * as L from 'leaflet';\nimport { setEvents } from './events';\nimport { Config } from '../config';\n\nconst convertGeometryCoordinates = (geometry) => {\n  if (typeof geometry === 'string') {\n    try {\n      return JSON.parse(geometry);\n    } catch (error) {\n      console.warn('Failed to parse the geometry string.');\n      return null;\n    }\n  }\n  return null;\n};\n\nconst createHyperleafletGeometryParams = (dataset) => {\n  const hyperleafletOptions = Config.options;\n  const { geometry, geometryType, style, popup, tooltip, id } = dataset;\n  const { styles } = hyperleafletOptions;\n\n  const convertedGeometry = convertGeometryCoordinates(geometry);\n  const computedStyle = styles?.[geometryType]?.[style];\n\n  const options = {\n    style: computedStyle,\n    popup,\n    tooltip,\n    id,\n  };\n\n  return { geometry: convertedGeometry, geometryType, options };\n};\n\nexport const Geometry = {\n  types: {\n    point: {\n      create: (geometry, styleOptions, _extraParams) => L.marker(geometry, styleOptions),\n      update: (leafletObject, geometry) => leafletObject.setLatLng(geometry),\n      convert: (geometry, isLonLat) => (isLonLat ? [...geometry].reverse() : geometry),\n      eventType: 'mono',\n    },\n    linestring: {\n      create: (geometry, styleOptions, _extraParams) => L.polyline(geometry, styleOptions),\n      update: (leafletObject, geometry) => leafletObject.setLatLngs(geometry),\n      convert: (geometry, isLonLat) => (isLonLat ? L.GeoJSON.coordsToLatLngs(geometry, 0) : geometry),\n      eventType: 'poly',\n    },\n    polygon: {\n      create: (geometry, styleOptions, _extraParams) => L.polygon(geometry, styleOptions),\n      update: (leafletObject, geometry) => leafletObject.setLatLngs(geometry),\n      convert: (geometry, isLonLat) => (isLonLat ? L.GeoJSON.coordsToLatLngs(geometry, 1) : geometry),\n      eventType: 'poly',\n    },\n  },\n\n  addType(type, handlers) {\n    if (!handlers.create || !handlers.update || !handlers.convert) {\n      throw new Error('Invalid handlers provided.');\n    }\n\n    this.types[type] = handlers;\n  },\n\n  shouldReverseCoordinates(reverseCoordinateOrder, reverseOrder) {\n    return reverseCoordinateOrder || reverseOrder !== undefined;\n  },\n  applyPopupAndTooltip(leafletGeometry, options) {\n    if (options.popup) {\n      leafletGeometry.bindPopup(options.popup);\n    }\n    if (options.tooltip) {\n      leafletGeometry.bindTooltip(options.tooltip);\n    }\n  },\n\n  createGeometry(dataset) {\n    const { reverseOrder, ...extraOptions } = dataset;\n    const { reverseCoordinateOrder } = Config.options;\n    const { geometry, geometryType, options } = createHyperleafletGeometryParams(dataset);\n\n    const geometryCreator = this.types[geometryType.toLowerCase()];\n\n    const isLonLat = this.shouldReverseCoordinates(reverseCoordinateOrder, reverseOrder);\n\n    if (!geometryCreator) {\n      throw new Error(`Invalid geometry type: ${geometryType}`);\n    }\n\n    const convertedGeometry = geometryCreator.convert(geometry, isLonLat);\n\n    const leafletGeometry = geometryCreator.create(convertedGeometry, options.style, extraOptions);\n    this.applyPopupAndTooltip(leafletGeometry, options);\n\n    setEvents(leafletGeometry, options.id, geometryCreator.eventType);\n    return leafletGeometry;\n  },\n\n  updateGeometry(leafletObject, dataset) {\n    const { reverseOrder } = dataset;\n    const { reverseCoordinateOrder } = Config.options;\n\n    const isLonLat = this.shouldReverseCoordinates(reverseCoordinateOrder, reverseOrder);\n    const { geometry, geometryType } = createHyperleafletGeometryParams(dataset);\n    const typeInfo = this.types[geometryType.toLowerCase()];\n\n    if (!typeInfo) {\n      throw new Error(`Invalid geometry type: ${geometryType}`);\n    }\n\n    const convertedGeometry = typeInfo.convert(geometry, isLonLat);\n    return typeInfo.update(leafletObject, convertedGeometry);\n  },\n};\n","import { sendEvent } from '../Geometry/events';\nimport { Geometry } from '../Geometry/geometry';\n\nexport function createGeometryHandler(map, layerModule) {\n  function addNodeToHyperleaflet(node) {\n    const {\n      dataset,\n      dataset: { layerName, id },\n    } = node;\n\n    let target = map;\n    if (layerName) {\n      const layer = layerModule.getLayerGroup(layerName);\n      if (!layer) {\n        target = layerModule.createLayerGroup(layerName);\n        target.addTo(map);\n      } else {\n        target = layer;\n      }\n    }\n\n    const leafletGeometry = Geometry.createGeometry(dataset);\n    sendEvent('add', leafletGeometry, id, dataset.geometryType, target);\n    leafletGeometry.hlID = id;\n    leafletGeometry.addTo(target);\n  }\n\n  function deleteNodeFromHyperleaflet(node) {\n    const rowId = node.dataset.id;\n    const { layerName } = node.dataset;\n\n    const layer = layerModule.getLayerGroup(layerName);\n\n    const target = layer || map;\n\n    const leafletLayers = Object.values(target._layers);\n    const leafletObject = leafletLayers.find((_layer) => _layer.hlID === rowId);\n\n    target.removeLayer(leafletObject);\n    sendEvent('remove', leafletObject, rowId, node.dataset.geometryType, target);\n    layerModule.deleteLayerGroup(layerName, { ifEmpty: true });\n  }\n\n  function changeNodeInHyperleaflet(change) {\n    const rowId = change['data-id'];\n\n    const leafletLayers = Object.values(map._layers);\n    const leafletObject = leafletLayers.find((layer) => layer.hlID === rowId);\n\n    switch (change.attribute) {\n      case 'data-geometry': {\n        sendEvent('change', leafletObject, rowId, change.dataset.geometryType, map);\n        return Geometry.updateGeometry(leafletObject, change.dataset);\n      }\n      default: {\n        throw new Error('Unsupported attribute change!');\n      }\n    }\n  }\n\n  return { addNodeToHyperleaflet, deleteNodeFromHyperleaflet, changeNodeInHyperleaflet };\n}\n","import { Config } from '../config';\n\nexport function sendHyperleafletReady(map) {\n  const eventTarget = Config.getTarget('hyperleaflet');\n\n  if (Config.options.events.hyperleaflet.ready) {\n    const bounds = map.getBounds();\n    const min = bounds.getSouthWest();\n    const max = bounds.getNorthEast();\n    const bboxString = bounds.toBBoxString();\n    const event = new CustomEvent('hyperleaflet:ready', {\n      detail: { zoom: map.getZoom(), center: map.getCenter(), bbox: { min, max }, bboxString },\n    });\n    eventTarget.dispatchEvent(event);\n  }\n}\n","import * as L from 'leaflet';\n\nexport const Layers = {\n  control: L.control.layers(),\n  layerGroups: {},\n\n  addBaseLayer(baseLayer, layerName) {\n    this.control.addBaseLayer(baseLayer, layerName);\n  },\n  getLayerGroup(layerName) {\n    return this.layerGroups?.[layerName];\n  },\n  createLayerGroup(layerName) {\n    const layerGroup = L.layerGroup();\n    this.layerGroups[layerName] = layerGroup;\n    this.control.addOverlay(layerGroup, layerName);\n    return layerGroup;\n  },\n  deleteLayerGroup(layerName, options = { ifEmpty: false }) {\n    if (options.ifEmpty && this.layerGroups[layerName].getLayers().length) {\n      return;\n    }\n    const layerGroup = this.layerGroups[layerName];\n    delete this.layerGroups[layerName];\n    this.control.removeLayer(layerGroup);\n  },\n};\n","import * as L from 'leaflet';\n\nexport const TileLayers = {\n  _tileLayers: {\n    OpenStreetMap: L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>',\n    }),\n    EsriWorldImagery: L.tileLayer(\n      'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',\n      {\n        attribution:\n          'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community',\n      },\n    ),\n  },\n  _addTileLayer(name, { url, minZoom = 0, maxZoom = 18, tms } = {}) {\n    if (this._tileLayers[name]) {\n      return;\n    }\n    const newTileLayer = new L.TileLayer(url, { minZoom, maxZoom, tms: !!tms });\n    this._tileLayers[name] = newTileLayer;\n  },\n\n  _getDefaultHyperleafletTile(tileLayerElementList) {\n    const defaultTileLayerElement = tileLayerElementList.find((t) => 'defaultTile' in t.dataset);\n    if (defaultTileLayerElement && defaultTileLayerElement.dataset.tile in this._tileLayers) {\n      return this._tileLayers[defaultTileLayerElement.dataset.tile];\n    }\n    if (tileLayerElementList.length && tileLayerElementList[0].dataset.tile in this._tileLayers) {\n      return this._tileLayers[tileLayerElementList[0].dataset.tile];\n    }\n    return this._tileLayers.OpenStreetMap;\n  },\n\n  tiles: [],\n  defaultTile: undefined,\n  nodesToTiles(tileLayerElementNodeList) {\n    const tileLayerElementList = Array.from(tileLayerElementNodeList);\n    tileLayerElementList.forEach((tileLayerElement) => {\n      const { tile } = tileLayerElement.dataset;\n\n      if (!(tile in this._tileLayers)) {\n        const { tileUrl, tms, minZoom, maxZoom } = tileLayerElement.dataset;\n        this._addTileLayer(tile, { url: tileUrl, tms, minZoom, maxZoom });\n      }\n      this.tiles.push({ name: tile, tile: this._tileLayers[tile] });\n    });\n\n    this.defaultTile = this._getDefaultHyperleafletTile(tileLayerElementList);\n    return {\n      defaultTile: this.defaultTile,\n      tiles: this.tiles,\n    };\n  },\n};\n","function makeEventTarget(object) {\n  const eventListeners = {};\n\n  Object.assign(object, {\n    addEventListener(type, listener) {\n      if (!(type in eventListeners)) {\n        eventListeners[type] = [];\n      }\n      eventListeners[type].push(listener);\n    },\n    removeEventListener(type, listener) {\n      if (!(type in eventListeners)) {\n        return;\n      }\n      const index = eventListeners[type].indexOf(listener);\n      if (index !== -1) {\n        eventListeners[type].splice(index, 1);\n      }\n    },\n    dispatchEvent(event) {\n      if (!(event.type in eventListeners)) {\n        return true;\n      }\n      const listeners = eventListeners[event.type].slice();\n      for (const listener of listeners) {\n        listener.call(object, event);\n      }\n      return !event.defaultPrevented;\n    },\n  });\n}\n\nexport { makeEventTarget };\n","import hyperChangeDetection from '../Hyperchange/hyperchange';\n\nimport { Map_ } from '../Map/map';\nimport { createGeometryHandler } from './hyperleafletGeometryHandler';\nimport { sendHyperleafletReady } from './events';\nimport { Geometry } from '../Geometry/geometry';\nimport { Layers } from '../Layers/layers';\nimport { TileLayers } from '../Layers';\nimport { Config } from '../config';\nimport { makeEventTarget } from './eventTarget';\n\nconst HYPERLEAFLET_DATA_SOURCE = '[data-hyperleaflet-source]';\n\nexport const Hyperleaflet = {\n  beforeNodeAdd: [],\n  afterNodeAdd: [],\n  beforeNodeRemove: [],\n  afterNodeRemove: [],\n  beforeNodeChange: [],\n  afterNodeChange: [],\n  addNode: [],\n  removeNode: [],\n  changeNode: [],\n  customMapEvents: [],\n\n  initialize(mapContainer) {\n    if (!mapContainer) {\n      console.warn('Hyperleaflet: No map container found.');\n      return;\n    }\n    mapContainer.setAttribute('hyperleaflet', '');\n    const [map, target] = Map_.create(mapContainer);\n    this.map = map;\n    this.target = target;\n    this.initializeLayerControl(mapContainer, this.map);\n    this.initializeHyperleafletDataSource();\n    this.customMapEvents.forEach((hook) => hook(this.map, this.target));\n    sendHyperleafletReady(this.map);\n  },\n\n  addExtension(extension) {\n    if (extension.layer) {\n      Layers.control.addOverlay(extension.layer);\n    }\n\n    if (extension.handleMap) {\n      this.customMapEvents.push((map, mapTarget) => extension.handleMap(map, mapTarget));\n    }\n\n    const functionNames = [\n      'addNode',\n      'removeNode',\n      'changeNode',\n      'beforeNodeAdd',\n      'afterNodeAdd',\n      'beforeNodeRemove',\n      'afterNodeRemove',\n      'beforeNodeChange',\n      'afterNodeChange',\n    ];\n\n    functionNames.forEach((functionName) => {\n      if (extension[functionName] && typeof extension[functionName] === 'function') {\n        this[functionName].push((node) => extension[functionName](node));\n      }\n    });\n  },\n\n  initializeHyperleafletDataSource() {\n    const hyperleafletDataSource = document.querySelector(HYPERLEAFLET_DATA_SOURCE);\n\n    if (!hyperleafletDataSource) return;\n\n    const { addNodeToHyperleaflet, deleteNodeFromHyperleaflet, changeNodeInHyperleaflet } = createGeometryHandler(\n      this.map,\n      Layers,\n    );\n\n    this.map.whenReady(() => {\n      const nodes = hyperleafletDataSource.querySelectorAll('[data-id]');\n      nodes.forEach((node) => {\n        this.beforeNodeAdd.forEach((hook) => hook(node));\n        if (node.dataset.hyperleafletExtension) {\n          this.addNode.forEach((hook) => hook(node));\n        } else {\n          addNodeToHyperleaflet(node);\n        }\n        this.afterNodeAdd.forEach((hook) => hook(node));\n      });\n    });\n\n    hyperChangeDetection.observe({\n      targetSelector: HYPERLEAFLET_DATA_SOURCE,\n      uniqueAttribute: 'data-id',\n      attributeFilter: ['data-geometry'],\n    });\n\n    hyperChangeDetection.subscribe(HYPERLEAFLET_DATA_SOURCE, 'node_adds', (nodes) => {\n      nodes.forEach((node) => {\n        this.beforeNodeAdd.forEach((hook) => hook(node));\n        if (node.dataset.hyperleafletExtension) {\n          this.addNode.forEach((hook) => hook(node));\n        } else {\n          addNodeToHyperleaflet(node);\n        }\n        this.afterNodeAdd.forEach((hook) => hook(node));\n      });\n    });\n\n    hyperChangeDetection.subscribe(HYPERLEAFLET_DATA_SOURCE, 'node_removes', (nodes) => {\n      nodes.forEach((node) => {\n        this.beforeNodeRemove.forEach((hook) => hook(node));\n        if (node.dataset.hyperleafletExtension) {\n          this.removeNode.forEach((hook) => hook(node));\n        } else {\n          deleteNodeFromHyperleaflet(node);\n        }\n        this.afterNodeRemove.forEach((hook) => hook(node));\n      });\n    });\n\n    hyperChangeDetection.subscribe(HYPERLEAFLET_DATA_SOURCE, 'node_changes', (changes) => {\n      changes.forEach((change) => {\n        this.beforeNodeChange.forEach((hook) => hook(change));\n        if (change.dataset.hyperleafletExtension) {\n          this.changeNode.forEach((hook) => hook(change));\n        } else {\n          changeNodeInHyperleaflet(change);\n        }\n        this.afterNodeChange.forEach((hook) => hook(change));\n      });\n    });\n  },\n\n  initializeLayerControl(mapContainer) {\n    const tileLayerElementList = mapContainer.querySelectorAll('[data-tile]');\n    const { defaultTile, tiles } = TileLayers.nodesToTiles(tileLayerElementList);\n\n    const layerControl = Layers.control;\n    layerControl.addTo(this.map);\n\n    tiles.forEach(({ name, tile }) => {\n      Layers.addBaseLayer(tile, name);\n    });\n\n    defaultTile.addTo(this.map);\n  },\n\n  getZoom() {\n    return this.map.getZoom();\n  },\n\n  setZoom(zoom) {\n    this.map.setZoom(zoom);\n  },\n  getCenter() {\n    return this.map.getCenter();\n  },\n  fitBounds(bounds) {\n    this.map.fitBounds(bounds);\n  },\n  getBounds() {\n    return this.map.getBounds();\n  },\n  getBBoxString() {\n    return this.map.getBounds().toBBoxString();\n  },\n  panTo(center) {\n    this.map.panTo(center);\n  },\n  flyTo(center, zoom = undefined) {\n    zoom = zoom || this.map.getZoom();\n    this.map.flyTo(center, zoom);\n  },\n  flyToBounds(bounds) {\n    this.map.flyToBounds(bounds);\n  },\n};\n\nHyperleaflet.addGeometryType = (type, customGeometryType) => {\n  Geometry.addType(type, customGeometryType);\n};\n\nmakeEventTarget(Hyperleaflet);\n\nHyperleaflet.config = Config;\n\nConfig._hyperleaflet = Hyperleaflet;\n","import { Hyperleaflet } from './Hyperleaflet';\nimport { Config } from './config';\n\nfunction initializeMap() {\n  const mapContainer = document.querySelector(Config.options.mapElement);\n  if (mapContainer) {\n    Hyperleaflet.initialize(mapContainer);\n    return true;\n  }\n  return false;\n}\n\nfunction observeMap() {\n  const observer = new MutationObserver((_mutations, obs) => {\n    if (initializeMap()) {\n      obs.disconnect();\n    }\n  });\n  observer.observe(document.body, { childList: true, subtree: true });\n}\n\n(function () {\n  document.addEventListener('DOMContentLoaded', () => {\n    if (!initializeMap()) {\n      observeMap();\n    }\n  });\n})();\n\nwindow.hyperleaflet = Hyperleaflet;\nexport { Hyperleaflet as hyperleaflet };\n"],"names":["hyperChangeDetection","events","observe","_ref","targetSelector","uniqueAttribute","attributeFilter","Error","observeChangesInTarget","subscribe","evName","callback","push","unsubscribe","filter","f","publish","data","forEach","isEqualNode","oldNode","newNode","attributes","every","attribute","getAttribute","findNodesWithAttribute","nodes","result","node","nodeType","hasAttribute","apply","childNodes","observer","MutationObserver","mutationsList","removedNodes","addedNodes","mutation","type","_attributeChange","attributeName","attributeChange","from","oldValue","to","target","changedNode","_extends","dataset","changedNodes","removedNodeMap","Map","map","jointNodeSet","Set","addNode","addNodeId","get","add","attributeChanges","reduce","changes","attr","_changes$push","reallyRemovedNodes","has","reallyAddedNodes","length","targetNode","document","querySelector","childList","subtree","attributeOldValue","isObject","item","Array","isArray","mergeDeep","source","output","Object","keys","key","defaultOptions","reverseCoordinateOrder","mapElement","click","dblclick","mousedown","mouseover","mousemove","mouseout","contextmenu","preclick","zoom","move","zoomstart","zoomend","movestart","moveend","ready","geometry","hyperleaflet","styles","Config","_hyperleaflet","_options","options","reset","getTarget","window","createStateEvent","eventName","_leafletEvent","bounds","getBounds","min","getSouthWest","max","getNorthEast","bboxString","toBBoxString","CustomEvent","detail","getZoom","center","getCenter","bbox","stateEvents","mouseEvents","setMapEvents","eventTarget","mapEvents","entries","value","includes","on","e","event","dispatchEvent","point","latlng","whenReady","reverseCoordinates","reverse","safeParsePoint","pointJson","JSON","parse","_","Map_","create","mapContainer","config","mapConfig","_target$dataset","minZoom","maxZoom","mapView","leafletMap","L","setEvents","leafletObject","id","eventType","clickedPoint","getLatLng","getLatLngs","sendEvent","leafletGeometry","geometryType","convertGeometryCoordinates","error","console","warn","createHyperleafletGeometryParams","_styles$geometryType","hyperleafletOptions","style","popup","tooltip","convertedGeometry","computedStyle","Geometry","types","styleOptions","_extraParams","marker","update","setLatLng","convert","isLonLat","concat","linestring","polyline","setLatLngs","GeoJSON","coordsToLatLngs","polygon","addType","handlers","shouldReverseCoordinates","reverseOrder","undefined","applyPopupAndTooltip","bindPopup","bindTooltip","createGeometry","extraOptions","_objectWithoutPropertiesLoose","_excluded","_createHyperleafletGe","geometryCreator","toLowerCase","updateGeometry","_createHyperleafletGe2","typeInfo","createGeometryHandler","layerModule","addNodeToHyperleaflet","_node$dataset","layerName","layer","getLayerGroup","createLayerGroup","addTo","hlID","deleteNodeFromHyperleaflet","rowId","leafletLayers","values","_layers","find","_layer","removeLayer","deleteLayerGroup","ifEmpty","changeNodeInHyperleaflet","change","sendHyperleafletReady","Layers","control","layers","layerGroups","addBaseLayer","baseLayer","_this$layerGroups","layerGroup","addOverlay","getLayers","TileLayers","_tileLayers","OpenStreetMap","tileLayer","attribution","EsriWorldImagery","_addTileLayer","name","_temp","url","_ref$minZoom","_ref$maxZoom","tms","newTileLayer","TileLayer","_getDefaultHyperleafletTile","tileLayerElementList","defaultTileLayerElement","t","tile","tiles","defaultTile","nodesToTiles","tileLayerElementNodeList","_this","tileLayerElement","_tileLayerElement$dat","tileUrl","makeEventTarget","object","eventListeners","assign","addEventListener","listener","removeEventListener","index","indexOf","splice","listeners","slice","_iterator","_createForOfIteratorHelperLoose","_step","done","call","defaultPrevented","HYPERLEAFLET_DATA_SOURCE","Hyperleaflet","beforeNodeAdd","afterNodeAdd","beforeNodeRemove","afterNodeRemove","beforeNodeChange","afterNodeChange","removeNode","changeNode","customMapEvents","initialize","setAttribute","_Map_$create","initializeLayerControl","initializeHyperleafletDataSource","hook","addExtension","extension","_this2","handleMap","mapTarget","functionNames","functionName","_this3","hyperleafletDataSource","_createGeometryHandle","querySelectorAll","hyperleafletExtension","_TileLayers$nodesToTi","layerControl","setZoom","fitBounds","getBBoxString","panTo","flyTo","flyToBounds","addGeometryType","customGeometryType","initializeMap","observeMap","_mutations","obs","disconnect","body"],"mappings":"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"}